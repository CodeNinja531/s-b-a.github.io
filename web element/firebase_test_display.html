<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Data Display Test</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
    <h1>Firebase Data Display Test</h1>

    <div id="connectionStatus" style="font-weight: bold;"></div>
    <div id="firebaseData" style="margin-top: 20px;">
        <h2>Data from Firebase:</h2>
        <pre id="dataDisplay"></pre>
    </div>

    <script>
        // Initialize Firebase (LIVE server)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        let app;
        try {
            app = firebase.initializeApp(firebaseConfig);
            document.getElementById('connectionStatus').textContent = "Firebase (LIVE) initialized successfully.";
            document.getElementById('connectionStatus').style.color = "green";
        } catch (error) {
            document.getElementById('connectionStatus').textContent = "Firebase initialization failed: " + error.message;
            document.getElementById('connectionStatus').style.color = "red";
        }

        // Get a reference to the database service
        const database = firebase.database();

        // Function to read data from Firebase (local)
        function readFirebaseData() {
            // Example: show all schema roots as in database.txt
            const schemaRoots = [
                "stu_info",
                "event",
                "participants",
                "racing_result",
                "field_result",
                "relay_result"
            ];
            const dataDisplayElement = document.getElementById('dataDisplay');
            let results = {};
            let loaded = 0;

            schemaRoots.forEach((root) => {
                database.ref(root).once('value', (snapshot) => {
                    results[root] = snapshot.val();
                    loaded++;
                    if (loaded === schemaRoots.length) {
                        dataDisplayElement.textContent = JSON.stringify(results, null, 2);
                    }
                }, (errorObject) => {
                    results[root] = "Error: " + errorObject.message;
                    loaded++;
                    if (loaded === schemaRoots.length) {
                        dataDisplayElement.textContent = JSON.stringify(results, null, 2);
                    }
                });
            });
        }

        // Call the function to read data when the page loads
        readFirebaseData();

    </script>
</body>
</html>